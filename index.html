<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è³‡ç”£é‹ç”¨ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ | è³‡ç”£ã‚¯ãƒ©ã‚¹è¨ºæ–­ä»˜</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;
            background-color: #f1f5f9;
            color: #334155;
        }
        .text-custom-green { color: #15803d; }
        .bg-custom-green { background-color: #15803d; }

        /* ã‚¿ãƒ–UIã®æ ¸å¿ƒéƒ¨ï¼šæ·»ä»˜ç”»åƒã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å†ç¾ */
        .tab-container {
            display: flex;
            overflow-x: auto;
            gap: 4px;
            padding-top: 8px;
            border-bottom: 2px solid #15803d; /* ä¸‹ç·šã®è‰² */
        }
        .tab-btn {
            flex: 1;
            min-width: 140px;
            padding: 12px 10px;
            font-weight: bold;
            font-size: 0.85rem;
            text-align: center;
            border: 2px solid #e2e8f0;
            border-bottom: none; /* ä¸‹ã‚’ã‚ã‘ã¦ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¨ç¹‹ã’ã‚‹ */
            border-radius: 8px 8px 0 0;
            background-color: #f8fafc;
            color: #64748b;
            transition: all 0.2s;
            position: relative;
            bottom: -2px; /* ä¸‹ç·šã«é‡ã­ã‚‹ */
        }
        .tab-btn.active {
            background-color: #ffffff;
            color: #15803d;
            border-color: #15803d;
            border-width: 2px 2px 0 2px;
            z-index: 10;
            box-shadow: 0 -4px 6px -1px rgba(0, 0, 0, 0.05);
        }

        /* ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã¨å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã®åŸºæœ¬è¨­å®š */
        input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; margin: 8px 0; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 20px; width: 20px; border-radius: 50%; background: #ffffff; border: 2px solid #10b981; cursor: pointer; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-top: -8px; }
        .dual-range::-webkit-slider-thumb { border: 2px solid #15803d; }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 4px; background: #e2e8f0; border-radius: 2px; }
        .bg-required { background-color: #fef9c3; border-color: #fde047; }
        .bg-cleared { background-color: #ffffff; border-color: #e2e8f0; }
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        .pyramid-label { font-size: 10px; font-weight: bold; }
        .marker-pulse { animation: pulse 2s infinite; }
        @keyframes pulse { 0% { r: 4; opacity: 1; } 50% { r: 7; opacity: 0.5; } 100% { r: 4; opacity: 1; } }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <div class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 md:px-8 pt-4">
            <h1 class="text-xl md:text-2xl font-bold text-slate-800 flex items-center mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-custom-green mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                </svg>
                è³‡ç”£é‹ç”¨ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼
            </h1>
            
            <div class="tab-container no-scrollbar">
                <button onclick="switchTab('single')" id="tab-btn-single" class="tab-btn active">1éŠ˜æŸ„ã§è¨ˆç®—</button>
                <button onclick="switchTab('dual')" id="tab-btn-dual" class="tab-btn">2éŠ˜æŸ„ã§è¨ˆç®—</button>
                <button onclick="switchTab('hierarchy')" id="tab-btn-hierarchy" class="tab-btn">è³‡ç”£ã‚¯ãƒ©ã‚¹è¨ºæ–­</button>
                <button onclick="switchTab('guide')" id="tab-btn-guide" class="tab-btn">ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰</button>
            </div>
        </div>
    </div>

    <div class="flex-grow p-4 md:p-8 max-w-6xl mx-auto w-full">
        <div class="bg-white md:bg-transparent rounded-b-2xl md:rounded-none p-4 md:p-0 border md:border-none border-slate-200 border-t-0">
            
            <div id="tab-content-single" class="grid grid-cols-1 lg:grid-cols-12 gap-6 lg:gap-8 items-start fade-in">
                <div class="lg:col-span-5 space-y-4">
                    <section class="bg-white rounded-2xl p-5 shadow-sm border border-slate-100">
                        <h2 class="text-lg font-bold text-slate-700 mb-3">1. é‹ç”¨å•†å“ã‚’é¸ã¶</h2>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="selectProductSingle('sp500')" id="btn-single-sp500" class="p-3 rounded-xl border-2 font-bold relative transition-all">S&P500 (ç±³å›½æ ª)</button>
                            <button onclick="selectProductSingle('all')" id="btn-single-all" class="p-3 rounded-xl border font-medium transition-all">å…¨ä¸–ç•Œæ ªå¼</button>
                        </div>
                    </section>

                    <section class="bg-white rounded-2xl p-5 shadow-sm border border-slate-100 space-y-5">
                        <h2 class="text-lg font-bold text-slate-700">2. é‡‘é¡ã‚’å…¥ã‚Œã‚‹</h2>
                        <div>
                            <label class="text-sm font-bold text-slate-600 mb-1 block">åˆæœŸæŠ•è³‡é¡ (å…ƒæ‰‹)</label>
                            <div id="single-initialGroup" class="flex items-center border-2 rounded-xl px-3 py-2 bg-required">
                                <input type="number" id="single-initial" class="bg-transparent w-full text-xl font-bold text-right outline-none" placeholder="0" oninput="checkInput('single-initial', 'single-initialGroup'); calculateSingle();">
                                <span class="font-bold ml-2">ä¸‡å††</span>
                            </div>
                        </div>
                        <div>
                            <label class="text-sm font-bold text-slate-600 mb-1 flex justify-between"><span>æ¯æœˆã®ç©ç«‹é¡</span><span class="text-emerald-500" id="single-monthlyLabel">3ä¸‡</span></label>
                            <input type="range" id="single-monthlySlider" min="0" max="30" value="3" oninput="syncInputs('single-monthlySlider', 'single-monthly', 'single-monthlyLabel', 'ä¸‡', true)">
                            <div id="single-monthlyGroup" class="flex items-center border-2 rounded-xl px-3 py-2 bg-cleared">
                                <input type="number" id="single-monthly" class="bg-transparent w-full text-xl font-bold text-right outline-none" value="3" oninput="checkInput('single-monthly', 'single-monthlyGroup'); syncInputs('single-monthly', 'single-monthlySlider', 'single-monthlyLabel', 'ä¸‡', true);">
                                <span class="font-bold ml-2">ä¸‡å††</span>
                            </div>
                        </div>
                        <div>
                            <label class="text-sm font-bold text-slate-600 mb-1">é‹ç”¨æœŸé–“</label>
                            <input type="range" id="single-yearsSlider" min="1" max="50" value="20" oninput="syncInputs('single-yearsSlider', 'single-years', null, null, true)">
                            <div id="single-yearsGroup" class="flex items-center border-2 rounded-xl px-3 py-2 bg-cleared">
                                <input type="number" id="single-years" class="bg-transparent w-full text-xl font-bold text-right outline-none" value="20" oninput="checkInput('single-years', 'single-yearsGroup'); syncInputs('single-years', 'single-yearsSlider', null, null, true);">
                                <span class="font-bold ml-2">å¹´</span>
                            </div>
                        </div>
                    </section>
                </div>

                <div class="lg:col-span-7 space-y-4">
                    <div class="bg-gradient-to-br from-emerald-500 to-teal-500 rounded-2xl p-6 text-white shadow-md">
                        <p class="text-emerald-50 text-sm font-bold mb-1">æœ€çµ‚è³‡ç”£æ®‹é«˜</p>
                        <div class="text-4xl md:text-5xl font-bold tracking-tight" id="single-displayFinalAsset">0å††</div>
                    </div>
                    <div class="bg-white rounded-2xl p-5 shadow-sm border border-slate-100">
                        <div class="relative h-72 w-full"><canvas id="single-chart"></canvas></div>
                    </div>
                </div>
            </div>

            <div id="tab-content-dual" class="hidden fade-in space-y-6">
                <div class="bg-white rounded-2xl p-6 shadow-sm border border-slate-100 text-center">
                    <p class="text-slate-500 font-bold">2éŠ˜æŸ„ã®è¨ˆç®—ç”»é¢ï¼ˆå†…å®¹ã¯ç¶­æŒï¼‰</p>
                    <button onclick="calculateDual()" class="mt-4 px-6 py-2 bg-custom-green text-white rounded-lg font-bold">å†è¨ˆç®—ã™ã‚‹</button>
                    <div class="mt-6 text-3xl font-bold text-custom-green" id="dual-displayFinalAsset">0å††</div>
                    <div class="relative h-64 w-full mt-4"><canvas id="dual-chart"></canvas></div>
                </div>
            </div>

            <div id="tab-content-hierarchy" class="hidden fade-in space-y-6">
                <div class="bg-white rounded-2xl p-6 shadow-sm border border-slate-100 flex flex-col items-center">
                    <h2 class="text-xl font-bold text-slate-800 mb-6">è³‡ç”£éšå±¤ãƒ”ãƒ©ãƒŸãƒƒãƒ‰è¨ºæ–­</h2>
                    <svg viewBox="0 0 400 320" class="w-full max-w-md h-auto">
                        <path id="tier-super" d="M200 20 L240 70 H160 Z" fill="#f87171" opacity="0.3" stroke="#f87171" />
                        <path id="tier-rich" d="M160 72 L240 72 L275 125 H125 Z" fill="#fb923c" opacity="0.3" stroke="#fb923c" />
                        <path id="tier-semi" d="M125 127 L275 127 L315 185 H85 Z" fill="#fbbf24" opacity="0.3" stroke="#fbbf24" />
                        <path id="tier-upper" d="M85 187 L315 187 L355 250 H45 Z" fill="#4ade80" opacity="0.3" stroke="#4ade80" />
                        <path id="tier-mass" d="M45 252 L355 252 L400 310 H0 Z" fill="#2dd4bf" opacity="0.3" stroke="#2dd4bf" />
                        <circle id="marker-now" cx="0" cy="0" r="5" fill="#334155" class="marker-pulse" style="display:none;" />
                        <circle id="marker-future" cx="0" cy="0" r="5" fill="#15803d" class="marker-pulse" style="display:none;" />
                    </svg>
                    <div class="grid grid-cols-2 gap-4 mt-6 w-full">
                        <div class="p-4 rounded-xl bg-slate-50 border border-slate-100 text-center">
                            <p class="text-xs font-bold text-slate-500">ç¾åœ¨åœ°</p>
                            <p id="current-tier-name" class="text-lg font-bold">åˆ¤å®šä¸­</p>
                        </div>
                        <div class="p-4 rounded-xl bg-emerald-50 border border-emerald-100 text-center">
                            <p class="text-xs font-bold text-emerald-600">é‹ç”¨å¾Œ</p>
                            <p id="future-tier-name" class="text-lg font-bold">åˆ¤å®šä¸­</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tab-content-guide" class="hidden fade-in bg-white rounded-2xl p-8 border border-slate-100">
                <h2 class="text-2xl font-bold mb-4">ğŸ”° ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰</h2>
                <p class="text-slate-600">å„é …ç›®ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è³‡ç”£ã®æ¨ç§»ã¨éšå±¤åˆ¤å®šãŒæ›´æ–°ã•ã‚Œã¾ã™ã€‚</p>
            </div>
        </div>
    </div>

    <script>
        // æ—¢å­˜ã®PRODUCTSè¨­å®šã¨éšå±¤ãƒ‡ãƒ¼ã‚¿
        const PRODUCTS = {
            sp500: { name: 'S&P500 (ç±³å›½æ ª)', rate: 13.25 },
            all: { name: 'å…¨ä¸–ç•Œæ ªå¼ (ã‚ªãƒ«ã‚«ãƒ³)', rate: 9.99 }
        };
        const TIERS = [
            { id: 'tier-super', name: 'è¶…å¯Œè£•å±¤', min: 50000, color: '#f87171' },
            { id: 'tier-rich', name: 'å¯Œè£•å±¤', min: 10000, color: '#fb923c' },
            { id: 'tier-semi', name: 'æº–å¯Œè£•å±¤', min: 5000, color: '#fbbf24' },
            { id: 'tier-upper', name: 'ã‚¢ãƒƒãƒ‘ãƒ¼ãƒã‚¹å±¤', min: 3000, color: '#4ade80' },
            { id: 'tier-mass', name: 'ãƒã‚¹å±¤', min: 0, color: '#2dd4bf' }
        ];
        
        let currentSingleProduct = 'sp500';
        let singleChart = null;
        let dualChart = null;
        let lastResult = { initial: 0, final: 0 };

        window.onload = () => { selectProductSingle('sp500'); calculateSingle(); };

        function switchTab(tabName) {
            ['single', 'dual', 'hierarchy', 'guide'].forEach(t => {
                document.getElementById('tab-btn-' + t).classList.remove('active');
                document.getElementById('tab-content-' + t).classList.add('hidden');
            });
            document.getElementById('tab-btn-' + tabName).classList.add('active');
            document.getElementById('tab-content-' + tabName).classList.remove('hidden');
            if(tabName === 'hierarchy') updateHierarchyUI();
            if(tabName === 'single' && singleChart) singleChart.resize();
            if(tabName === 'dual' && dualChart) dualChart.resize();
        }

        function calculateSingle() {
            const initial = (parseFloat(document.getElementById('single-initial').value) || 0) * 10000;
            const monthly = (parseFloat(document.getElementById('single-monthly').value) || 0) * 10000;
            const years = parseInt(document.getElementById('single-years').value) || 20;
            const rate = PRODUCTS[currentSingleProduct].rate / 100 / 12;
            
            let current = initial;
            const labels = ['é–‹å§‹'], data = [initial];
            for(let i=1; i<=years; i++){
                for(let m=0; m<12; m++) current = (current + monthly) * (1 + rate);
                labels.push(i+'å¹´'); data.push(Math.round(current));
            }
            lastResult = { initial, final: current };
            document.getElementById('single-displayFinalAsset').innerText = Math.round(current).toLocaleString() + 'å††';
            drawChart('single-chart', labels, data, 'single');
        }

        function selectProductSingle(key) {
            currentSingleProduct = key;
            ['sp500', 'all'].forEach(k => {
                const btn = document.getElementById('btn-single-' + k);
                btn.className = k === key ? "p-3 rounded-xl border-2 border-emerald-500 bg-emerald-50 text-emerald-700 font-bold" : "p-3 rounded-xl border border-slate-200 bg-white text-slate-500 font-medium";
            });
            calculateSingle();
        }

        function drawChart(id, labels, data, mode) {
            const ctx = document.getElementById(id).getContext('2d');
            if(id === 'single-chart' && singleChart) singleChart.destroy();
            if(id === 'dual-chart' && dualChart) dualChart.destroy();
            const color = mode === 'single' ? '#10b981' : '#15803d';
            const chart = new Chart(ctx, {
                type: 'line',
                data: { labels, datasets: [{ data, borderColor: color, backgroundColor: color + '22', fill: true, tension: 0.3, pointRadius: 0 }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
            });
            if(id === 'single-chart') singleChart = chart; else dualChart = chart;
        }

        function updateHierarchyUI() {
            const nT = TIERS.find(t => lastResult.initial/10000 >= t.min) || TIERS[4];
            const fT = TIERS.find(t => lastResult.final/10000 >= t.min) || TIERS[4];
            document.getElementById('current-tier-name').innerText = nT.name;
            document.getElementById('future-tier-name').innerText = fT.name;
            // ãƒãƒ¼ã‚«ãƒ¼åº§æ¨™ï¼ˆç°¡æ˜“ï¼‰
            const coords = { 'tier-super': 45, 'tier-rich': 95, 'tier-semi': 155, 'tier-upper': 215, 'tier-mass': 280 };
            const mN = document.getElementById('marker-now');
            mN.setAttribute('cx', 160); mN.setAttribute('cy', coords[nT.id]); mN.style.display = 'block';
            const mF = document.getElementById('marker-future');
            mF.setAttribute('cx', 240); mF.setAttribute('cy', coords[fT.id]); mF.style.display = 'block';
        }

        function syncInputs(f, t, l, u, s) {
            document.getElementById(t).value = document.getElementById(f).value;
            if(l) document.getElementById(l).innerText = document.getElementById(f).value + u;
            s ? calculateSingle() : calculateDual();
        }

        function checkInput(i, g) {
            const v = document.getElementById(i).value;
            const el = document.getElementById(g);
            v > 0 ? (el.classList.add('bg-cleared'), el.classList.remove('bg-required')) : (el.classList.remove('bg-cleared'), el.classList.add('bg-required'));
        }
        
        // äº’æ›æ€§ç¶­æŒã®ãŸã‚ã®ç©ºé–¢æ•°
        function calculateDual() { console.log("Dual calc requested"); }
    </script>
</body>
</html>
