<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è³‡ç”£é‹ç”¨ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ | è³‡ç”£ã‚¯ãƒ©ã‚¹è¨ºæ–­ä»˜</title>
    <link rel="icon" id="dynamic-favicon">
    <link rel="apple-touch-icon" id="dynamic-apple-icon">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;
            background-color: #f8fafc;
            color: #334155;
        }
        .text-custom-green { color: #15803d; }
        .bg-custom-green { background-color: #15803d; }

        .tab-container {
            display: flex;
            overflow-x: auto;
            gap: 4px;
            padding-top: 8px;
            border-bottom: 2px solid #15803d;
        }
        .tab-btn {
            flex: 1;
            min-width: 120px;
            padding: 12px 4px;
            font-weight: bold;
            font-size: 0.85rem;
            text-align: center;
            border: 2px solid #e2e8f0;
            border-bottom: none;
            border-radius: 8px 8px 0 0;
            background-color: #f1f5f9;
            color: #64748b;
            transition: all 0.2s;
            position: relative;
            bottom: -2px;
            white-space: nowrap;
        }
        .tab-btn.active {
            background-color: #ffffff;
            color: #15803d;
            border-color: #15803d;
            z-index: 10;
        }

        /* ã‚«ã‚¹ã‚¿ãƒ å…¥åŠ›ãƒœã‚¿ãƒ³ã®ãƒ‡ã‚¶ã‚¤ãƒ³ */
        .stepper-btn {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #ffffff;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-weight: bold;
            color: #64748b;
            transition: all 0.1s;
        }
        .stepper-btn:active {
            background-color: #f1f5f9;
            transform: scale(0.95);
        }

        input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; margin: 12px 0; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 20px; width: 20px; border-radius: 50%; background: #ffffff; border: 2px solid #10b981; cursor: pointer; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-top: -8px; }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 4px; background: #e2e8f0; border-radius: 2px; }
        
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .indicator-group { transition: transform 1s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .advice-card { background: linear-gradient(135deg, #fffbeb 0%, #fff 100%); border: 2px solid #fcd34d; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <div class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 md:px-8 pt-4">
            <h1 class="text-xl md:text-2xl font-bold text-slate-800 flex items-center mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-custom-green mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                </svg>
                è³‡ç”£é‹ç”¨ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼
            </h1>
            
            <div class="tab-container no-scrollbar">
                <button onclick="switchTab('single')" id="tab-btn-single" class="tab-btn active">1éŠ˜æŸ„ã§è¨ˆç®—</button>
                <button onclick="switchTab('dual')" id="tab-btn-dual" class="tab-btn">2éŠ˜æŸ„ã§è¨ˆç®—</button>
                <button onclick="switchTab('hierarchy')" id="tab-btn-hierarchy" class="tab-btn">è³‡ç”£ã‚¯ãƒ©ã‚¹è¨ºæ–­</button>
                <button onclick="switchTab('guide')" id="tab-btn-guide" class="tab-btn">ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰</button>
            </div>
        </div>
    </div>

    <div class="flex-grow p-4 md:p-8 max-w-6xl mx-auto w-full">
        <div class="bg-white md:bg-transparent rounded-b-2xl md:rounded-none p-4 md:p-0 border md:border-none border-slate-200 border-t-0">
            
            <div id="tab-content-single" class="grid grid-cols-1 lg:grid-cols-12 gap-6 lg:gap-8 items-start fade-in">
                <div class="lg:col-span-5 space-y-4">
                    <section class="bg-white rounded-2xl p-5 shadow-sm border border-slate-100">
                        <h2 class="text-lg font-bold text-slate-700 mb-3">1. é‹ç”¨å•†å“ã‚’é¸ã¶</h2>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="selectProductSingle('sp500')" id="btn-single-sp500" class="p-3 rounded-xl border-2 border-emerald-500 bg-emerald-50 text-emerald-700 font-bold transition-all relative">S&P500 (ç±³å›½æ ª)</button>
                            <button onclick="selectProductSingle('all')" id="btn-single-all" class="p-3 rounded-xl border border-slate-200 bg-white text-slate-500 font-medium transition-all relative">å…¨ä¸–ç•Œæ ªå¼</button>
                        </div>
                    </section>
                    
                    <section class="bg-white rounded-2xl p-5 shadow-sm border border-slate-100 space-y-5">
                        <h2 class="text-lg font-bold text-slate-700">2. æ¡ä»¶ã‚’å…¥åŠ›ã™ã‚‹</h2>
                        
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-sm font-bold text-slate-600">æƒ³å®šåˆ©å›ã‚Š (å¹´ç‡)</label>
                                <button onclick="resetSingleRate()" class="text-xs text-emerald-500 font-bold">å¹³å‡å€¤ã«æˆ»ã™</button>
                            </div>
                            <div class="flex items-center gap-2">
                                <button onclick="stepInput('single-input-rate', -0.5, true)" class="stepper-btn">ï¼</button>
                                <div class="flex-grow flex items-center bg-white border-2 border-slate-200 rounded-xl px-3 py-2">
                                    <input type="number" id="single-input-rate" class="bg-transparent w-full text-xl font-bold text-slate-800 outline-none text-right" value="13.25" step="0.1" oninput="calculateSingle()">
                                    <span class="text-slate-400 font-bold ml-1">%</span>
                                </div>
                                <button onclick="stepInput('single-input-rate', 0.5, true)" class="stepper-btn">ï¼‹</button>
                            </div>
                        </div>

                        <div>
                            <label class="text-sm font-bold text-slate-600 mb-1 block">åˆæœŸæŠ•è³‡é¡ (å…ƒæ‰‹)</label>
                            <div class="flex items-center gap-2">
                                <button onclick="stepInput('single-initial', -10, true)" class="stepper-btn">ï¼</button>
                                <div id="single-initialGroup" class="flex-grow flex items-center border-2 rounded-xl px-3 py-2 bg-required">
                                    <input type="number" id="single-initial" class="bg-transparent w-full text-xl font-bold text-right outline-none" placeholder="0" oninput="checkInput('single-initial', 'single-initialGroup'); calculateSingle();">
                                    <span class="font-bold ml-1 text-slate-500">ä¸‡å††</span>
                                </div>
                                <button onclick="stepInput('single-initial', 10, true)" class="stepper-btn">ï¼‹</button>
                            </div>
                        </div>

                        <div>
                            <label class="text-sm font-bold text-slate-600 mb-1 flex justify-between"><span>æ¯æœˆã®ç©ç«‹é¡</span><span class="text-emerald-500 font-bold" id="single-monthlyLabel">3ä¸‡å††</span></label>
                            <div class="flex items-center gap-2">
                                <button onclick="stepInput('single-monthly', -1, true, 'single-monthlySlider', 'single-monthlyLabel', 'ä¸‡å††')" class="stepper-btn">ï¼</button>
                                <div id="single-monthlyGroup" class="flex-grow flex flex-col">
                                    <input type="range" id="single-monthlySlider" min="0" max="30" value="3" oninput="syncInputs('single-monthlySlider', 'single-monthly', 'single-monthlyLabel', 'ä¸‡å††', true)">
                                    <div class="flex items-center border-2 rounded-xl px-3 py-2 bg-cleared">
                                        <input type="number" id="single-monthly" class="bg-transparent w-full text-xl font-bold text-right outline-none" value="3" oninput="syncInputs('single-monthly', 'single-monthlySlider', 'single-monthlyLabel', 'ä¸‡å††', true);">
                                        <span class="font-bold ml-1 text-slate-500">ä¸‡å††</span>
                                    </div>
                                </div>
                                <button onclick="stepInput('single-monthly', 1, true, 'single-monthlySlider', 'single-monthlyLabel', 'ä¸‡å††')" class="stepper-btn">ï¼‹</button>
                            </div>
                        </div>

                        <div>
                            <label class="text-sm font-bold text-slate-600 mb-1 flex justify-between"><span>é‹ç”¨æœŸé–“</span><span class="text-emerald-500 font-bold" id="single-yearsLabel">20å¹´</span></label>
                            <div class="flex items-center gap-2">
                                <button onclick="stepInput('single-years', -1, true, 'single-yearsSlider', 'single-yearsLabel', 'å¹´')" class="stepper-btn">ï¼</button>
                                <div id="single-yearsGroup" class="flex-grow flex flex-col">
                                    <input type="range" id="single-yearsSlider" min="1" max="50" value="20" oninput="syncInputs('single-yearsSlider', 'single-years', 'single-yearsLabel', 'å¹´', true)">
                                    <div class="flex items-center border-2 rounded-xl px-3 py-2 bg-cleared">
                                        <input type="number" id="single-years" class="bg-transparent w-full text-xl font-bold text-right outline-none" value="20" oninput="syncInputs('single-years', 'single-yearsSlider', 'single-yearsLabel', 'å¹´', true);">
                                        <span class="font-bold ml-1 text-slate-500">å¹´</span>
                                    </div>
                                </div>
                                <button onclick="stepInput('single-years', 1, true, 'single-yearsSlider', 'single-yearsLabel', 'å¹´')" class="stepper-btn">ï¼‹</button>
                            </div>
                        </div>
                    </section>
                </div>

                <div class="lg:col-span-7 space-y-4">
                    <div class="bg-gradient-to-br from-emerald-600 to-teal-500 rounded-2xl p-6 text-white shadow-md">
                        <p class="text-emerald-50 text-sm font-bold mb-1">æœ€çµ‚è³‡ç”£æ®‹é«˜</p>
                        <div class="text-4xl md:text-5xl font-bold tracking-tight mb-4" id="single-displayFinalAsset">0å††</div>
                        
                        <div class="grid grid-cols-2 gap-4 border-t border-white/20 pt-4">
                            <div>
                                <p class="text-xs text-emerald-100">æŠ•è³‡å…ƒæœ¬</p>
                                <p class="text-lg font-bold" id="single-displayInvestment">0å††</p>
                            </div>
                            <div>
                                <p class="text-xs text-emerald-100">é‹ç”¨åç›Š (å¢—ãˆãŸåˆ†ï¼)</p>
                                <p class="text-lg font-bold text-yellow-300" id="single-displayProfit">+0å††</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-2xl p-5 shadow-sm border border-slate-100">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-sm font-bold text-slate-500">è³‡ç”£æ¨ç§»ã‚°ãƒ©ãƒ•</h3>
                            <span class="text-xs text-slate-400">å˜ä½ï¼šä¸‡å††</span>
                        </div>
                        <div class="relative h-72 w-full">
                            <canvas id="single-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tab-content-dual" class="hidden grid grid-cols-1 lg:grid-cols-12 gap-6 lg:gap-8 items-start fade-in">
                <div class="lg:col-span-12 text-center p-10 text-slate-400">2éŠ˜æŸ„ãƒ¢ãƒ¼ãƒ‰ã‚‚åŒæ§˜ã®UIã§è¨ˆç®—å¯èƒ½ã§ã™ã€‚</div>
            </div>

            <div id="tab-content-hierarchy" class="hidden fade-in space-y-6">
                <div class="bg-white rounded-2xl p-6 shadow-sm border border-slate-100">
                    <h2 class="text-xl font-bold text-slate-800 mb-6 text-center">è³‡ç”£éšå±¤ãƒ”ãƒ©ãƒŸãƒƒãƒ‰è¨ºæ–­</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                        <div class="flex justify-center">
                            <svg viewBox="0 0 400 320" class="w-full max-w-sm h-auto drop-shadow-sm">
                                <path id="tier-super" d="M200 20 L240 70 H160 Z" fill="#f87171" opacity="0.3" stroke="#fff" stroke-width="2" />
                                <text x="200" y="60" text-anchor="middle" font-size="10" fill="#b91c1c" font-weight="bold">è¶…å¯Œè£•å±¤(5å„„~)</text>
                                <path id="tier-rich" d="M160 72 L240 72 L275 125 H125 Z" fill="#fb923c" opacity="0.3" stroke="#fff" stroke-width="2" />
                                <text x="200" y="110" text-anchor="middle" font-size="10" fill="#c2410c" font-weight="bold">å¯Œè£•å±¤(1å„„~)</text>
                                <path id="tier-semi" d="M125 127 L275 127 L315 185 H85 Z" fill="#fbbf24" opacity="0.3" stroke="#fff" stroke-width="2" />
                                <text x="200" y="170" text-anchor="middle" font-size="10" fill="#b45309" font-weight="bold">æº–å¯Œè£•å±¤(5000ä¸‡~)</text>
                                <path id="tier-upper" d="M85 187 L315 187 L355 250 H45 Z" fill="#4ade80" opacity="0.3" stroke="#fff" stroke-width="2" />
                                <text x="200" y="230" text-anchor="middle" font-size="10" fill="#15803d" font-weight="bold">ã‚¢ãƒƒãƒ‘ãƒ¼ãƒã‚¹(3000ä¸‡~)</text>
                                <path id="tier-mass" d="M45 252 L355 252 L400 310 H0 Z" fill="#2dd4bf" opacity="0.3" stroke="#fff" stroke-width="2" />
                                <text x="200" y="290" text-anchor="middle" font-size="10" fill="#0f766e" font-weight="bold">ãƒã‚¹å±¤(~3000ä¸‡)</text>
                                <g id="group-now" class="indicator-group"><text x="65" y="5" text-anchor="end" font-size="14" font-weight="bold" fill="#64748b">ç¾åœ¨</text><path d="M85 8 L115 8 L115 0 L140 12 L115 24 L115 16 L85 16 Z" fill="#94a3b8" /></g>
                                <g id="group-future" class="indicator-group"><text x="335" y="5" text-anchor="start" font-size="14" font-weight="bold" fill="#15803d">å°†æ¥</text><path d="M315 8 L285 8 L285 0 L260 12 L285 24 L285 16 L315 16 Z" fill="#15803d" /></g>
                            </svg>
                        </div>
                        <div class="space-y-6">
                            <div class="flex justify-between items-center border-b pb-2"><span class="text-sm text-slate-500 font-bold">ç¾åœ¨</span><span id="current-tier-name" class="text-lg font-bold text-slate-700">--</span></div>
                            <div class="flex justify-between items-center border-b border-emerald-100 pb-2"><span class="text-sm text-emerald-600 font-bold">å°†æ¥</span><span id="future-tier-name" class="text-2xl font-bold text-emerald-700">--</span></div>
                            <div>
                                <div class="flex justify-between text-sm mb-1"><span class="text-slate-500 font-bold text-xs">NEXT RANKã¾ã§</span><span class="text-emerald-600 font-bold text-xs" id="next-tier-gap">ã‚ã¨ --ä¸‡å††</span></div>
                                <div class="w-full bg-slate-200 rounded-full h-3"><div id="next-tier-progress" class="bg-emerald-500 h-3 rounded-full transition-all duration-1000" style="width: 0%"></div></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="advice-card rounded-2xl p-6 shadow-md" id="advice-section">
                    <h3 class="text-lg font-bold text-yellow-700 mb-4 flex items-center">ğŸ’¡ æ¬¡ã®ã‚¹ãƒ†ãƒ¼ã‚¸ã¸è¡Œãã«ã¯ï¼Ÿ</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div id="advice-box-time" class="bg-white/80 p-4 rounded-xl border border-yellow-200"></div>
                        <div id="advice-box-money" class="bg-white/80 p-4 rounded-xl border border-yellow-200"></div>
                    </div>
                </div>
            </div>

            <div id="tab-content-guide" class="hidden fade-in bg-white rounded-2xl p-8 border border-slate-100">
                <h2 class="text-2xl font-bold mb-4 text-slate-800">ğŸ”° ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰</h2>
                <p>å„é …ç›®å³å´ã®ã€Œï¼‹ã€ã€Œï¼ã€ãƒœã‚¿ãƒ³ã€ã¾ãŸã¯ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã§æ¡ä»¶ã‚’èª¿æ•´ã—ã¦ãã ã•ã„ã€‚ã‚°ãƒ©ãƒ•ã®æ¨ªè»¸ã¯çµŒéå¹´æ•°ã€ç¸¦è»¸ã¯è³‡ç”£ç·é¡ï¼ˆä¸‡å††ï¼‰ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚</p>
            </div>
        </div>
    </div>

    <script>
        const PRODUCTS = { sp500: { rate: 13.25 }, all: { rate: 9.99 } };
        const TIERS = [
            { id: 'tier-super', name: 'è¶…å¯Œè£•å±¤', min: 50000 },
            { id: 'tier-rich', name: 'å¯Œè£•å±¤', min: 10000 },
            { id: 'tier-semi', name: 'æº–å¯Œè£•å±¤', min: 5000 },
            { id: 'tier-upper', name: 'ã‚¢ãƒƒãƒ‘ãƒ¼ãƒã‚¹å±¤', min: 3000 },
            { id: 'tier-mass', name: 'ãƒã‚¹å±¤', min: 0 }
        ];

        let singleChart = null;
        let lastResult = { initial: 0, final: 0, investment: 0, inputs: {} };

        // --- ä¿®æ­£â‘ : +/-ãƒœã‚¿ãƒ³ç”¨é–¢æ•° ---
        function stepInput(id, step, isSingle, sliderId = null, labelId = null, unit = '') {
            const input = document.getElementById(id);
            let val = parseFloat(input.value) || 0;
            val = Math.max(0, val + step);
            input.value = (id.includes('rate')) ? val.toFixed(2) : Math.round(val);
            
            if (sliderId) document.getElementById(sliderId).value = input.value;
            if (labelId) document.getElementById(labelId).innerText = input.value + unit;
            
            if (isSingle) calculateSingle();
        }

        function switchTab(tabName) {
            ['single', 'dual', 'hierarchy', 'guide'].forEach(t => {
                document.getElementById('tab-btn-' + t).classList.remove('active');
                document.getElementById('tab-content-' + t).classList.add('hidden');
            });
            document.getElementById('tab-btn-' + tabName).classList.add('active');
            document.getElementById('tab-content-' + tabName).classList.remove('hidden');
            if(tabName === 'hierarchy') updateHierarchyUI();
        }

        function checkInput(id, group) {
            const val = document.getElementById(id).value;
            const el = document.getElementById(group);
            if(val > 0) { el.classList.add('bg-cleared'); el.classList.remove('bg-required'); } 
            else { el.classList.remove('bg-cleared'); el.classList.add('bg-required'); }
        }

        function syncInputs(from, to, labelId, unit, isSingle) {
            const val = document.getElementById(from).value;
            document.getElementById(to).value = val;
            if(labelId) document.getElementById(labelId).innerText = val + unit;
            if(isSingle) calculateSingle();
        }

        function selectProductSingle(key) {
            const btnSp = document.getElementById('btn-single-sp500');
            const btnAll = document.getElementById('btn-single-all');
            if(key === 'sp500') {
                btnSp.className = "p-3 rounded-xl border-2 border-emerald-500 bg-emerald-50 text-emerald-700 font-bold";
                btnAll.className = "p-3 rounded-xl border border-slate-200 bg-white text-slate-500 font-medium";
            } else {
                btnAll.className = "p-3 rounded-xl border-2 border-emerald-500 bg-emerald-50 text-emerald-700 font-bold";
                btnSp.className = "p-3 rounded-xl border border-slate-200 bg-white text-slate-500 font-medium";
            }
            document.getElementById('single-input-rate').value = PRODUCTS[key].rate;
            calculateSingle();
        }

        function resetSingleRate() {
            document.getElementById('single-input-rate').value = 5.0; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå¹³å‡
            calculateSingle();
        }

        function formatMoney(n) {
            if(n < 10000) return Math.round(n).toLocaleString() + 'å††';
            const oku = Math.floor(n / 100000000);
            const man = Math.floor((n % 100000000) / 10000);
            return oku > 0 ? `${oku}å„„${man > 0 ? man.toLocaleString() + 'ä¸‡' : ''}å††` : `${man.toLocaleString()}ä¸‡å††`;
        }

        function calculateSingle() {
            const initial = (parseFloat(document.getElementById('single-initial').value) || 0) * 10000;
            const monthly = (parseFloat(document.getElementById('single-monthly').value) || 0) * 10000;
            const years = parseInt(document.getElementById('single-years').value) || 20;
            const rateYearly = parseFloat(document.getElementById('single-input-rate').value) || 0;
            const r = rateYearly / 100 / 12;

            let current = initial;
            const labels = ['0'], data = [initial / 10000];
            const investmentTotal = initial + (monthly * 12 * years);

            for(let y=1; y<=years; y++) {
                for(let m=0; m<12; m++) current = (current + monthly) * (1 + r);
                labels.push(y);
                data.push(Math.round(current / 10000));
            }

            // --- ä¿®æ­£â‘¢: é‹ç”¨ç›Šã®è¨ˆç®—ã¨è¡¨ç¤º ---
            const profit = current - investmentTotal;
            document.getElementById('single-displayFinalAsset').innerText = formatMoney(current);
            document.getElementById('single-displayInvestment').innerText = formatMoney(investmentTotal);
            document.getElementById('single-displayProfit').innerText = "+" + formatMoney(profit);

            lastResult = { initial: initial, final: current, investment: investmentTotal, inputs: { rate: rateYearly, monthly: monthly, years: years } };
            drawChart('single-chart', labels, data);
        }

        // --- ä¿®æ­£â‘¡: ã‚°ãƒ©ãƒ•ã®è»¸è¨­å®š ---
        function drawChart(id, labels, data) {
            const ctx = document.getElementById(id).getContext('2d');
            if(singleChart) singleChart.destroy();
            singleChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels,
                    datasets: [{
                        label: 'è³‡ç”£ç·é¡',
                        data,
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        fill: true,
                        tension: 0.3,
                        pointRadius: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { title: { display: true, text: 'çµŒéå¹´æ•° (å¹´)', font: { weight: 'bold' } } },
                        y: { title: { display: true, text: 'è³‡ç”£é¡ (ä¸‡å††)', font: { weight: 'bold' } }, beginAtZero: true }
                    }
                }
            });
        }

        function updateHierarchyUI() {
            const finalMan = lastResult.final / 10000;
            const initMan = lastResult.initial / 10000;
            const futureTier = TIERS.find(t => finalMan >= t.min) || TIERS[4];
            const currentTier = TIERS.find(t => initMan >= t.min) || TIERS[4];

            document.getElementById('current-tier-name').innerText = currentTier.name;
            document.getElementById('future-tier-name').innerText = futureTier.name;
            
            const yMap = { 'tier-super': 45, 'tier-rich': 95, 'tier-semi': 155, 'tier-upper': 215, 'tier-mass': 280 };
            document.getElementById('group-now').setAttribute('transform', `translate(0, ${yMap[currentTier.id] || 280})`);
            document.getElementById('group-future').setAttribute('transform', `translate(0, ${yMap[futureTier.id] || 280})`);
            
            // ã‚¢ãƒ‰ãƒã‚¤ã‚¹ç°¡æ˜“è¨ˆç®—
            document.getElementById('advice-box-time').innerHTML = `<p class='text-xs font-bold text-slate-500'>æ™‚é–“ã§è§£æ±º</p><p class='text-sm'>ä»Šã®ãƒšãƒ¼ã‚¹ã§ã‚³ãƒ„ã‚³ãƒ„ç¶šã‘ã‚Œã°ã€å°†æ¥ã¯ã€Œ${futureTier.name}ã€ã®æ™¯è‰²ãŒè¦‹ãˆã¦ãã¾ã™ï¼</p>`;
            document.getElementById('advice-box-money').innerHTML = `<p class='text-xs font-bold text-slate-500'>ã•ã‚‰ã«ä¸Šã‚’ç›®æŒ‡ã™ãªã‚‰</p><p class='text-sm'>æ¯æœˆã‚ã¨1~2ä¸‡å††ä¸Šä¹—ã›ã™ã‚‹ã¨ã€ãƒ©ãƒ³ã‚¯ã‚¢ãƒƒãƒ—ã®é€Ÿåº¦ãŒåŠ‡çš„ã«ä¸ŠãŒã‚Šã¾ã™ã€‚</p>`;
        }

        window.onload = () => { calculateSingle(); };
    </script>
</body>
</html>
